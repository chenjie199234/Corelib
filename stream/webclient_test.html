<!DOCTYPE HTML>
<html>
   <head>
   <meta charset="utf-8">
   <title>ws test</title>
    
      <script type="text/javascript">
         function WebSocketTest()
         {
            if ("WebSocket" in window)
            {
		    var init = false
		    var ws = new WebSocket("ws:127.0.0.1:9234/ws")
		    ws.onopen = function(){
			    console.log("open")
			    var num='00000000';
			    var str1='';
			    if(typeof num !='String'){
				    var str=num.toString();
			    }
			    var Hlong=Math.ceil(str.length/8);
			    for(var i=0;i<Hlong;i++){
				    str1+=String.fromCharCode(parseInt(str.substring(i*8,(i+1)*8),2));
			    }
			    var str2=str1+str1+str1+str1+str1+str1+str1+str1;
			    var msg="r"+str2+"testgroup.wsclient"+"testc"
			    console.log(msg.length)
			    console.log(msg)
			    ws.send(msg)
		    }
		    ws.onmessage = function(evt){
			    console.log("message")
			    if (!init){
				    init = true
				    var num='10000000';
				    console.log(evt)
				    var starttime = evt.data.slice(1,9,String)
				    var str1='';
				    if(typeof num !='String'){
					    var str=num.toString();
				    }
				    var Hlong=Math.ceil(str.length/8);
				    for(var i=0;i<Hlong;i++){
					    str1+=String.fromCharCode(parseInt(str.substring(i*8,(i+1)*8),2));
				    }
				    console.log(starttime)
				    var str2=str1+"123"
				    console.log(str2.length)
				    ws.send(123)
			    }else{
				    console.log(evt.data)
			    }
		    }
		    ws.onerror = function(evt){
			    console.log("error")
		    }
		    ws.onclose = function(){
			    console.log("close")
		    }
            }
            else
            {
               alert("Browser not support WebSocket");
            }
         }
      </script>
        
   </head>
   <body>
   
      <div id="sse">
         <a href="javascript:WebSocketTest()">Run WebSocket</a>
      </div>
      
   </body>
</html>
